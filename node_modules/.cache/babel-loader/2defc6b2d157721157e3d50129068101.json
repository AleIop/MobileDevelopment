{"ast":null,"code":"import * as firebase from \"firebase/app\";\nimport \"firebase/firestore\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyBXCX1Bb5S3OeJSmPsGr9B2J6iS9LVs2pQ\",\n  authDomain: \"mobut-project.firebaseapp.com\",\n  databaseURL: \"https://mobut-project.firebaseio.com\",\n  projectId: \"mobut-project\",\n  storageBucket: \"mobut-project.appspot.com\",\n  messagingSenderId: \"685766846531\",\n  appId: \"1:685766846531:web:39b5f7b9d38e6c22fdccf6\"\n}; // Initialize Firebase\n\nfirebase.initializeApp(firebaseConfig); // Listener for the players in the lobby\n\nlet lobbyListener;\n\nfunction addPlayerToLobby(player_name, url) {\n  let player_id = player_name.replace(/\\s/g, '_');\n  return firebase.firestore().collection('lobby').doc(player_id).set({\n    playerName: player_name,\n    playerId: player_id,\n    imgURL: url,\n    ready: false\n  }).catch(function (error) {\n    console.error('Error adding a player to the lobby', error);\n  });\n}\n\nfunction stopListeningToLobby() {\n  if (lobbyListener !== undefined) {\n    lobbyListener();\n  }\n}\n\nfunction ListenToPlayersInLobby(callback) {\n  lobbyListener = firebase.firestore().collection(\"lobby\").onSnapshot(function (querySnapshot) {\n    var playersInLobby = [];\n    querySnapshot.forEach(function (doc) {\n      playersInLobby.push(doc.data());\n    });\n    callback(playersInLobby);\n  }, function onError(error) {\n    console.error(\"Error listening to lobby: \", error);\n  });\n}\n\nasync function getPlayersInLobby() {\n  var playersInLobby = [];\n  await firebase.firestore().collection(\"lobby\").get().then(querySnapshot => {\n    querySnapshot.forEach(function (doc) {\n      playersInLobby.push(doc.data());\n    });\n  });\n  return playersInLobby;\n}\n\nfunction getPlayersInGame(game_id) {\n  return firebase.firestore().collection(\"games\").doc(game_id).get();\n}\n\nfunction removePlayerFromLobby(player_id) {\n  firebase.firestore().collection(\"lobby\").doc(player_id).delete().then(function () {\n    console.log(\"Player succesfully removed!\");\n  }).catch(function (error) {\n    console.error(\"Error removing lobby: \", error);\n  });\n}\n\nfunction removePlayerFromGame(game_id, player_id) {\n  getPlayersInGame(game_id).then(function (game) {\n    let players = game.players;\n    let new_players = [];\n    players.forEach(player => {\n      if (player.playerId !== player_id) {\n        new_players.push(player);\n      }\n    });\n    firebase.firestore().collection('games').doc(game_id).set({\n      players: new_players\n    }).then(function (docRef) {\n      console.log(\"Successfully removed the player with id: \", player_id);\n    }).catch(function (error) {\n      console.error('Error removing the player with id', player_id, \" error: \", error);\n    });\n  });\n}\n\nfunction removePlayersInLobby(playersInLobby) {\n  playersInLobby.forEach(function (player) {\n    removePlayerFromLobby(player.playerId);\n  });\n}\n\nfunction addPlayersToNewGame(playersInLobby) {\n  firebase.firestore().collection('games').add({\n    players: playersInLobby\n  }).then(function (docRef) {\n    console.log(\"Successfully added players to newly created game with ID: \", docRef.id);\n    return playersInLobby;\n  }).catch(function (error) {\n    console.error('Error adding players to new game', error);\n  });\n}\n\nfunction createNewGame() {\n  return getPlayersInLobby().then(function (lobby) {\n    console.log('lobby :', lobby);\n    var playersInLobby = [];\n    lobby.forEach(function (doc) {\n      playersInLobby.push(doc.data());\n    });\n    console.log(\"players in lobby:\", playersInLobby);\n    return playersInLobby;\n  }).then(addPlayersToNewGame).then(removePlayersInLobby).catch(function (error) {\n    console.error(\"Error creating a new game:\", error);\n  });\n}\n\nfunction setPlayerReadyStatus(player_id, status) {\n  firebase.firestore().collection('lobby').doc(player_id).update({\n    ready: status\n  }).catch(function (error) {\n    console.error('Error setting the player ready status', error);\n  });\n}\n\nfunction createFakeLobby() {\n  addPlayerToLobby(\"DJ COW\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/0/06/MushCow2.jpeg/revision/latest?cb=20190803151753');\n  addPlayerToLobby(\"Bengt\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/e/e7/4C2C755B-FB01-4351-886E-077F5B03CF16.jpeg/revision/latest?cb=20190811175416');\n  addPlayerToLobby(\"Sven\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/d/dd/Sven.png/revision/latest?cb=20191130204116');\n  addPlayerToLobby(\"Sven's BF\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/b/ba/SvenYellow.jpeg/revision/latest?cb=20190814205003');\n  addPlayerToLobby(\"Water Sheep\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/d/db/Water_Sheep%27s_Return.png/revision/latest?cb=20191129235246');\n  addPlayerToLobby(\"Ulla Britta\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/6/6d/BCBBA22C-0452-4B35-8C67-52F8345D734F.jpeg/revision/latest?cb=20190805181119');\n  addPlayerToLobby(\"Flip Flop\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/c/c7/Flip_Flop.jpeg/revision/latest?cb=20190922230718');\n} // TODO: any functions to handle the end of a game?\n\n\nexport { createNewGame, addPlayerToLobby, createFakeLobby, ListenToPlayersInLobby, getPlayersInLobby, setPlayerReadyStatus, stopListeningToLobby };","map":{"version":3,"sources":["/Users/Alessandro/Documents/GitHub/mobut-project/src/components/firebase-database.component.js"],"names":["firebase","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","initializeApp","lobbyListener","addPlayerToLobby","player_name","url","player_id","replace","firestore","collection","doc","set","playerName","playerId","imgURL","ready","catch","error","console","stopListeningToLobby","undefined","ListenToPlayersInLobby","callback","onSnapshot","querySnapshot","playersInLobby","forEach","push","data","onError","getPlayersInLobby","get","then","getPlayersInGame","game_id","removePlayerFromLobby","delete","log","removePlayerFromGame","game","players","new_players","player","docRef","removePlayersInLobby","addPlayersToNewGame","add","id","createNewGame","lobby","setPlayerReadyStatus","status","update","createFakeLobby"],"mappings":"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","sourcesContent":["import * as firebase from \"firebase/app\";\nimport \"firebase/firestore\";\n\nconst firebaseConfig = {\n    apiKey: \"AIzaSyBXCX1Bb5S3OeJSmPsGr9B2J6iS9LVs2pQ\",\n    authDomain: \"mobut-project.firebaseapp.com\",\n    databaseURL: \"https://mobut-project.firebaseio.com\",\n    projectId: \"mobut-project\",\n    storageBucket: \"mobut-project.appspot.com\",\n    messagingSenderId: \"685766846531\",\n    appId: \"1:685766846531:web:39b5f7b9d38e6c22fdccf6\"\n};\n\n// Initialize Firebase\nfirebase.initializeApp(firebaseConfig);\n\n// Listener for the players in the lobby\nlet lobbyListener;\n\nfunction addPlayerToLobby(player_name, url) {\n    let player_id = player_name.replace(/\\s/g, '_');\n\n    return firebase.firestore().collection('lobby').doc(player_id).set({\n        playerName: player_name,\n        playerId: player_id,\n        imgURL: url,\n        ready: false\n    })\n        .catch(function (error) {\n            console.error('Error adding a player to the lobby', error);\n        });\n}\n\nfunction stopListeningToLobby() {\n    if (lobbyListener !== undefined) {\n        lobbyListener();\n    }\n}\n\nfunction ListenToPlayersInLobby(callback) {\n    lobbyListener = firebase.firestore().collection(\"lobby\").onSnapshot(function (querySnapshot) {\n        var playersInLobby = [];\n        querySnapshot.forEach(function (doc) {\n            playersInLobby.push(doc.data());\n        });\n        callback(playersInLobby);\n    }, function onError(error) {\n        console.error(\"Error listening to lobby: \", error);\n    });\n}\n\nasync function getPlayersInLobby() {\n    var playersInLobby = [];\n    await firebase.firestore().collection(\"lobby\").get().then(querySnapshot => {\n        querySnapshot.forEach(function (doc) {\n            playersInLobby.push(doc.data());\n        });\n    });\n    return playersInLobby;\n}\n\nfunction getPlayersInGame(game_id) {\n    return firebase.firestore().collection(\"games\").doc(game_id).get();\n}\n\nfunction removePlayerFromLobby(player_id) {\n    firebase.firestore().collection(\"lobby\").doc(player_id).delete().then(function () {\n        console.log(\"Player succesfully removed!\");\n    }).catch(function (error) {\n        console.error(\"Error removing lobby: \", error);\n    });\n}\n\nfunction removePlayerFromGame(game_id, player_id) {\n\n    getPlayersInGame(game_id)\n        .then(function (game) {\n            let players = game.players;\n            let new_players = [];\n            players.forEach(player => {\n                if (player.playerId !== player_id) {\n                    new_players.push(player);\n                }\n            });\n            firebase.firestore().collection('games').doc(game_id).set({\n                players: new_players\n            })\n                .then(function (docRef) {\n                    console.log(\"Successfully removed the player with id: \", player_id);\n                })\n                .catch(function (error) {\n                    console.error('Error removing the player with id', player_id, \" error: \", error);\n                });\n        })\n}\n\n\nfunction removePlayersInLobby(playersInLobby) {\n    playersInLobby.forEach(function (player) {\n        removePlayerFromLobby(player.playerId);\n    });\n}\n\nfunction addPlayersToNewGame(playersInLobby) {\n    firebase.firestore().collection('games').add({\n        players: playersInLobby\n    })\n        .then(function (docRef) {\n            console.log(\"Successfully added players to newly created game with ID: \", docRef.id);\n            return playersInLobby;\n        })\n        .catch(function (error) {\n            console.error('Error adding players to new game', error);\n        });\n}\n\nfunction createNewGame() {\n    return getPlayersInLobby()\n        .then(function (lobby) {\n            console.log('lobby :', lobby);\n            var playersInLobby = [];\n            lobby.forEach(function (doc) {\n                playersInLobby.push(doc.data());\n            });\n            console.log(\"players in lobby:\", playersInLobby);\n            return playersInLobby;\n        })\n        .then(addPlayersToNewGame)\n        .then(removePlayersInLobby)\n        .catch(function (error) {\n            console.error(\"Error creating a new game:\", error);\n        });\n\n}\n\nfunction setPlayerReadyStatus(player_id, status) {\n    firebase.firestore().collection('lobby').doc(player_id).update({\n        ready: status\n    })\n        .catch(function (error) {\n            console.error('Error setting the player ready status', error);\n        });\n\n}\n\nfunction createFakeLobby() {\n    addPlayerToLobby(\"DJ COW\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/0/06/MushCow2.jpeg/revision/latest?cb=20190803151753');\n    addPlayerToLobby(\"Bengt\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/e/e7/4C2C755B-FB01-4351-886E-077F5B03CF16.jpeg/revision/latest?cb=20190811175416');\n    addPlayerToLobby(\"Sven\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/d/dd/Sven.png/revision/latest?cb=20191130204116');\n    addPlayerToLobby(\"Sven's BF\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/b/ba/SvenYellow.jpeg/revision/latest?cb=20190814205003');\n    addPlayerToLobby(\"Water Sheep\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/d/db/Water_Sheep%27s_Return.png/revision/latest?cb=20191129235246');\n    addPlayerToLobby(\"Ulla Britta\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/6/6d/BCBBA22C-0452-4B35-8C67-52F8345D734F.jpeg/revision/latest?cb=20190805181119');\n    addPlayerToLobby(\"Flip Flop\", 'https://vignette.wikia.nocookie.net/pewdiepieminecraft/images/c/c7/Flip_Flop.jpeg/revision/latest?cb=20190922230718');\n}\n\n\n// TODO: any functions to handle the end of a game?\n\n\n\n\n\n\nexport { createNewGame, addPlayerToLobby, createFakeLobby, ListenToPlayersInLobby, getPlayersInLobby, setPlayerReadyStatus, stopListeningToLobby };"]},"metadata":{},"sourceType":"module"}